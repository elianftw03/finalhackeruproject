import { useState } from "react";
import axios from "../api/axiosInstance";
import { useToast } from "../components/Toast";
import "../styles/Form.css";

function AddPet() {
  const { toast } = useToast();
  const [form, setForm] = useState({
    name: "",
    species: "",
    breed: "",
    age: "",
    gender: "",
    size: "",
    image: "",
    description: "",
    city: "",
    status: "available",
    vaccinated: false,
    neutered: false,
    contactName: "",
    contactPhone: "",
    contactEmail: ""
  });

  const onChange = (e) => {
    const { name, value, type, checked } = e.target;
    setForm((f) => ({ ...f, [name]: type === "checkbox" ? checked : value }));
  };

  const onSubmit = async (e) => {
    e.preventDefault();
    try {
      await axios.post("/pets", {
        ...form,
        age: Number(form.age)
      });
      toast("Pet added");
      setForm({
        name: "",
        species: "",
        breed: "",
        age: "",
        gender: "",
        size: "",
        image: "",
        description: "",
        city: "",
        status: "available",
        vaccinated: false,
        neutered: false,
        contactName: "",
        contactPhone: "",
        contactEmail: ""
      });
    } catch {
      toast("Failed to add pet");
    }
  };

  return (
    <div className="form-wrap">
      <div className="form-card">
        <h2 className="form-title">Add Pet</h2>
        <form onSubmit={onSubmit}>
          <div className="form-grid">
            <div className="form-row">
              <label>Name</label>
              <input name="name" value={form.name} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>Species</label>
              <select name="species" value={form.species} onChange={onChange}>
                <option value="">Select</option>
                <option>Dog</option>
                <option>Cat</option>
                <option>Rabbit</option>
                <option>Bird</option>
                <option>Horse</option>
                <option>Reptile</option>
              </select>
            </div>
            <div className="form-row">
              <label>Breed</label>
              <input name="breed" value={form.breed} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>Age</label>
              <input type="number" name="age" value={form.age} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>Gender</label>
              <select name="gender" value={form.gender} onChange={onChange}>
                <option value="">Select</option>
                <option>Male</option>
                <option>Female</option>
              </select>
            </div>
            <div className="form-row">
              <label>Size</label>
              <select name="size" value={form.size} onChange={onChange}>
                <option value="">Select</option>
                <option>Small</option>
                <option>Medium</option>
                <option>Large</option>
              </select>
            </div>
            <div className="form-row">
              <label>Image URL</label>
              <input name="image" value={form.image} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>City</label>
              <input name="city" value={form.city} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>Status</label>
              <select name="status" value={form.status} onChange={onChange}>
                <option>available</option>
                <option>adopted</option>
              </select>
            </div>
            <div className="form-row">
              <label>Contact Name</label>
              <input name="contactName" value={form.contactName} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>Contact Phone</label>
              <input name="contactPhone" value={form.contactPhone} onChange={onChange} />
            </div>
            <div className="form-row">
              <label>Contact Email</label>
              <input name="contactEmail" value={form.contactEmail} onChange={onChange} />
            </div>
            <div className="form-row" style={{ gridColumn: "1 / -1" }}>
              <label>Description</label>
              <textarea name="description" value={form.description} onChange={onChange} />
            </div>
            <div className="form-row" style={{ gridColumn: "1 / -1", display: "flex", alignItems: "center", gap: "16px" }}>
              <label style={{ margin: 0 }}>
                <input type="checkbox" name="vaccinated" checked={form.vaccinated} onChange={onChange} /> Vaccinated
              </label>
              <label style={{ margin: 0 }}>
                <input type="checkbox" name="neutered" checked={form.neutered} onChange={onChange} /> Neutered
              </label>
            </div>
          </div>
          <div className="form-actions">
            <button type="submit" className="btn-primary">Save</button>
            <button type="reset" className="btn-ghost" onClick={() => window.history.back()}>Cancel</button>
          </div>
        </form>
      </div>
    </div>
  );
}

export default AddPet;